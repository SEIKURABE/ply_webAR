(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{11752:function(e,t,r){e.exports=r(84785)},66156:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return y}});var n=r(19848),s=r.n(n),a=r(67294),o=r(15319),i=r(29095),l=r(30398),u=r(74250),c=r(51349),f=r(85893),p=function(){return(0,f.jsxs)("mesh",{children:[(0,f.jsx)("sphereGeometry",{args:[.5,16,16]}),(0,f.jsx)("meshStandardMaterial",{color:"gray",wireframe:!0})]})},h=function(e){var t=e.url,r=e.pointSize,n=(0,a.useState)(null),s=n[0],o=n[1],i=(0,a.useState)(!0),l=i[0],h=i[1],d=(0,a.useRef)(new u.UY4({size:void 0===r?.01:r,vertexColors:!0}));return((0,a.useEffect)(function(){if(!t){h(!1);return}var e=new c.F,r=new AbortController,n=!0;return fetch(t,{method:"HEAD",cache:"no-store"}).then(function(r){if(!r.ok)throw Error("モデルが見つかりません (404): ".concat(t));e.load(t,function(e){if(n){e.computeVertexNormals(),e.computeBoundingBox();var t=e.boundingBox;if(t){var r=new u.Pa4;t.getCenter(r),e.translate(-r.x,-r.y,-r.z)}o(e),h(!1)}},function(e){console.log(e.loaded/e.total*100+"% loaded")},function(e){n&&(console.error(e.message||"PLYファイルの読み込みに失敗しました"),h(!1))})}).catch(function(e){console.error("Fetch error:",e),h(!1)}),function(){n=!1,r.abort(),s&&s.dispose(),d.current&&d.current.dispose()}},[t]),l)?(0,f.jsx)(p,{}):s?(0,f.jsx)("points",{geometry:s,material:d.current,rotation:[0,Math.PI,0]}):null},d=function(){var e=(0,o.D)().scene;return(0,a.useEffect)(function(){return e.background=new u.Ilk(1118481),function(){e.background=null}},[e]),null},m=function(e){var t=e.modelUrl;return(0,a.useEffect)(function(){console.log("PLYViewer received modelUrl:",t)},[t]),(0,f.jsx)("div",{style:{width:"100%",height:"100%"},children:(0,f.jsxs)(i.Xz,{shadows:!0,children:[(0,f.jsx)(d,{}),(0,f.jsx)("ambientLight",{intensity:.8}),(0,f.jsx)("directionalLight",{position:[10,10,5],intensity:1,castShadow:!0}),t?(0,f.jsx)(h,{url:t}):(0,f.jsx)(p,{}),(0,f.jsx)("axesHelper",{args:[1]}),(0,f.jsx)(l.z,{enablePan:!0,enableZoom:!0,enableRotate:!0})]})})},g=r(11752),x=r.n(g)()().publicRuntimeConfig.basePath||"",y=function(){return(0,f.jsxs)("div",{className:"jsx-402270574 page-index",children:[(0,f.jsx)(m,{modelUrl:"".concat(x,"/model/demo/frames/frame17.ply")}),(0,f.jsx)(s(),{id:"402270574",children:[".page-index{width:100%;height:100%;background-color:#fff;position:absolute;}"]})]})}},48312:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(66156)}])},51349:function(e,t,r){"use strict";r.d(t,{F:function(){return a}});var n=r(74250);let s=new n.Ilk;class a extends n.aNw{constructor(e){super(e),this.propertyNameMapping={},this.customPropertyMapping={}}load(e,t,r,s){let a=this,o=new n.hH6(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(r){try{t(a.parse(r))}catch(t){s?s(t):console.error(t),a.manager.itemError(e)}},r,s)}setPropertyNameMapping(e){this.propertyNameMapping=e}setCustomPropertyNameMapping(e){this.customPropertyMapping=e}parse(e){let t;function r(e,t=0){let r;let n="",s=/^ply([\s\S]*)end_header(\r\n|\r|\n)/.exec(e);null!==s&&(n=s[1]);let a={comments:[],elements:[],headerLength:t,objInfo:""},o=n.split(/\r\n|\r|\n/);for(let e=0;e<o.length;e++){let t=o[e];if(""===(t=t.trim()))continue;let n=t.split(/\s+/),s=n.shift();switch(t=n.join(" "),s){case"format":a.format=n[0],a.version=n[1];break;case"comment":a.comments.push(t);break;case"element":void 0!==r&&a.elements.push(r),(r={}).name=n[0],r.count=parseInt(n[1]),r.properties=[];break;case"property":r.properties.push(function(e,t){let r={type:e[0]};return"list"===r.type?(r.name=e[3],r.countType=e[1],r.itemType=e[2]):r.name=e[1],r.name in t&&(r.name=t[r.name]),r}(n,p.propertyNameMapping));break;case"obj_info":a.objInfo=t;break;default:console.log("unhandled",s,n)}}return void 0!==r&&a.elements.push(r),a}function a(e,t){switch(t){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(e);case"float":case"double":case"float32":case"float64":return parseFloat(e)}}function i(){let e={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[],faceVertexColors:[]};for(let t of Object.keys(p.customPropertyMapping))e[t]=[];return e}function l(e){let t=e.map(e=>e.name);function r(e){for(let r=0,n=e.length;r<n;r++){let n=e[r];if(t.includes(n))return n}return null}return{attrX:r(["x","px","posx"])||"x",attrY:r(["y","py","posy"])||"y",attrZ:r(["z","pz","posz"])||"z",attrNX:r(["nx","normalx"]),attrNY:r(["ny","normaly"]),attrNZ:r(["nz","normalz"]),attrS:r(["s","u","texture_u","tx"]),attrT:r(["t","v","texture_v","ty"]),attrR:r(["red","diffuse_red","r","diffuse_r"]),attrG:r(["green","diffuse_green","g","diffuse_g"]),attrB:r(["blue","diffuse_blue","b","diffuse_b"])}}function u(e,t){let r,n;let s=i();r=null!==(n=/end_header\s+(\S[\s\S]*\S|\S)\s*$/.exec(e))?n[1].split(/\s+/):[];let u=new o(r);e:for(let e=0;e<t.elements.length;e++){let r=t.elements[e],n=l(r.properties);for(let e=0;e<r.count;e++){let e=function(e,t){let r={};for(let n=0;n<e.length;n++){if(t.empty())return null;if("list"===e[n].type){let s=[],o=a(t.next(),e[n].countType);for(let r=0;r<o;r++){if(t.empty())return null;s.push(a(t.next(),e[n].itemType))}r[e[n].name]=s}else r[e[n].name]=a(t.next(),e[n].type)}return r}(r.properties,u);if(!e)break e;f(s,r.name,e,n)}}return c(s)}function c(e){let t=new n.u9r;for(let r of(e.indices.length>0&&t.setIndex(e.indices),t.setAttribute("position",new n.a$l(e.vertices,3)),e.normals.length>0&&t.setAttribute("normal",new n.a$l(e.normals,3)),e.uvs.length>0&&t.setAttribute("uv",new n.a$l(e.uvs,2)),e.colors.length>0&&t.setAttribute("color",new n.a$l(e.colors,3)),(e.faceVertexUvs.length>0||e.faceVertexColors.length>0)&&(t=t.toNonIndexed(),e.faceVertexUvs.length>0&&t.setAttribute("uv",new n.a$l(e.faceVertexUvs,2)),e.faceVertexColors.length>0&&t.setAttribute("color",new n.a$l(e.faceVertexColors,3))),Object.keys(p.customPropertyMapping)))e[r].length>0&&t.setAttribute(r,new n.a$l(e[r],p.customPropertyMapping[r].length));return t.computeBoundingSphere(),t}function f(e,t,r,a){if("vertex"===t)for(let t of(e.vertices.push(r[a.attrX],r[a.attrY],r[a.attrZ]),null!==a.attrNX&&null!==a.attrNY&&null!==a.attrNZ&&e.normals.push(r[a.attrNX],r[a.attrNY],r[a.attrNZ]),null!==a.attrS&&null!==a.attrT&&e.uvs.push(r[a.attrS],r[a.attrT]),null!==a.attrR&&null!==a.attrG&&null!==a.attrB&&(s.setRGB(r[a.attrR]/255,r[a.attrG]/255,r[a.attrB]/255,n.KI_),e.colors.push(s.r,s.g,s.b)),Object.keys(p.customPropertyMapping)))for(let n of p.customPropertyMapping[t])e[t].push(r[n]);else if("face"===t){let t=r.vertex_indices||r.vertex_index,o=r.texcoord;3===t.length?(e.indices.push(t[0],t[1],t[2]),o&&6===o.length&&(e.faceVertexUvs.push(o[0],o[1]),e.faceVertexUvs.push(o[2],o[3]),e.faceVertexUvs.push(o[4],o[5]))):4===t.length&&(e.indices.push(t[0],t[1],t[3]),e.indices.push(t[1],t[2],t[3])),null!==a.attrR&&null!==a.attrG&&null!==a.attrB&&(s.setRGB(r[a.attrR]/255,r[a.attrG]/255,r[a.attrB]/255,n.KI_),e.faceVertexColors.push(s.r,s.g,s.b),e.faceVertexColors.push(s.r,s.g,s.b),e.faceVertexColors.push(s.r,s.g,s.b))}}let p=this;if(e instanceof ArrayBuffer){let n=new Uint8Array(e),{headerText:s,headerLength:a}=function(e){let t=0,r=!0,n="",s=[],a=new TextDecoder().decode(e.subarray(0,5)),o=/^ply\r\n/.test(a);do{let a=String.fromCharCode(e[t++]);"\n"!==a&&"\r"!==a?n+=a:("end_header"===n&&(r=!1),""!==n&&(s.push(n),n=""))}while(r&&t<e.length);return!0===o&&t++,{headerText:s.join("\r")+"\r",headerLength:t}}(n),o=r(s,a);if("ascii"===o.format){let e=new TextDecoder().decode(n);t=u(e,o)}else t=function(e,t){let r=i(),n="binary_little_endian"===t.format,s=new DataView(e,t.headerLength),a,o=0;for(let e=0;e<t.elements.length;e++){let i=t.elements[e],u=i.properties,c=l(u);!function(e,t,r){function n(e,t,r){switch(t){case"int8":case"char":return{read:t=>e.getInt8(t),size:1};case"uint8":case"uchar":return{read:t=>e.getUint8(t),size:1};case"int16":case"short":return{read:t=>e.getInt16(t,r),size:2};case"uint16":case"ushort":return{read:t=>e.getUint16(t,r),size:2};case"int32":case"int":return{read:t=>e.getInt32(t,r),size:4};case"uint32":case"uint":return{read:t=>e.getUint32(t,r),size:4};case"float32":case"float":return{read:t=>e.getFloat32(t,r),size:4};case"float64":case"double":return{read:t=>e.getFloat64(t,r),size:8}}}for(let s=0,a=e.length;s<a;s++){let a=e[s];"list"===a.type?(a.countReader=n(t,a.countType,r),a.valueReader=n(t,a.itemType,r)):a.valueReader=n(t,a.type,r)}}(u,s,n);for(let e=0;e<i.count;e++){a=function(e,t){let r={},n=0;for(let s=0;s<t.length;s++){let a=t[s],o=a.valueReader;if("list"===a.type){let t=[],s=a.countReader.read(e+n);n+=a.countReader.size;for(let r=0;r<s;r++)t.push(o.read(e+n)),n+=o.size;r[a.name]=t}else r[a.name]=o.read(e+n),n+=o.size}return[r,n]}(o,u),o+=a[1];let e=a[0];f(r,i.name,e,c)}}return c(r)}(e,o)}else t=u(e,r(e));return t}}class o{constructor(e){this.arr=e,this.i=0}empty(){return this.i>=this.arr.length}next(){return this.arr[this.i++]}}}},function(e){e.O(0,[934,737,848,95,398,774,888,179],function(){return e(e.s=48312)}),_N_E=e.O()}]);