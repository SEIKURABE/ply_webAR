(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[840],{60664:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var n=r(67294),s=r(15029),a=r(33214),i=r(59888),o=r(99477),u=r(51349),l=r(85893),c=function(e){var t=e.geometries,r=e.material,s=e.frameDuration,i=(0,n.useState)(0),o=i[0],u=i[1],c=(0,n.useRef)(performance.now());return(0,a.A)(function(){var e=performance.now();e-c.current>s&&(u(function(e){return(e+1)%t.length}),c.current=e)}),(0,l.jsx)("points",{geometry:t[o],material:r,rotation:[0,Math.PI,0]})},f=function(e){var t=e.modelUrls,r=e.pointSize,a=e.frameDuration,f=(0,n.useState)([]),p=f[0],h=f[1],d=(0,n.useState)(!0),m=d[0],g=d[1],y=(0,n.useState)(0),x=y[0],b=y[1],v=(0,n.useRef)(new o.PointsMaterial({size:void 0===r?.01:r,vertexColors:!0}));return((0,n.useEffect)(function(){var e=new u.F,r=[],n=0;return t.forEach(function(s,a){e.load(s,function(e){e.attributes.normal||e.computeVertexNormals(),e.computeBoundingBox();var s=e.boundingBox;if(s){var i=new o.Vector3;s.getCenter(i),e.translate(-i.x,-i.y,-i.z)}r[a]=e,b(++n),n===t.length&&(h(r),g(!1))})}),function(){r.forEach(function(e){return e.dispose()})}},[t]),m)?(0,l.jsxs)("div",{style:{textAlign:"center",padding:"20px"},children:[(0,l.jsxs)("p",{children:["Loading ",x,"/",t.length," models..."]}),(0,l.jsx)("progress",{value:x,max:t.length,style:{width:"100%"}})]}):0===p.length?null:(0,l.jsxs)(s.Xz,{children:[(0,l.jsx)("ambientLight",{intensity:.8}),(0,l.jsx)("directionalLight",{position:[10,10,5],intensity:1}),(0,l.jsx)(c,{geometries:p,material:v.current,frameDuration:void 0===a?50:a}),(0,l.jsx)("axesHelper",{args:[1]}),(0,l.jsx)(i.z,{enablePan:!0,enableZoom:!0,enableRotate:!0})]})};function p(){var e=Array.from({length:50},function(e,t){return"model/demo/frames/frame".concat(t,".ply")});return(0,l.jsx)("div",{style:{width:"100%",height:"100%",position:"absolute"},children:(0,l.jsx)(f,{modelUrls:e})})}},81940:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/PlyAnimation",function(){return r(60664)}])},51349:function(e,t,r){"use strict";r.d(t,{F:function(){return a}});var n=r(99477);let s=new n.Color;class a extends n.Loader{constructor(e){super(e),this.propertyNameMapping={},this.customPropertyMapping={}}load(e,t,r,s){let a=this,i=new n.FileLoader(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,function(r){try{t(a.parse(r))}catch(t){s?s(t):console.error(t),a.manager.itemError(e)}},r,s)}setPropertyNameMapping(e){this.propertyNameMapping=e}setCustomPropertyNameMapping(e){this.customPropertyMapping=e}parse(e){let t;function r(e){let t;let r="",n=0,s=/^ply([\s\S]*)end_header(\r\n|\r|\n)/.exec(e);null!==s&&(r=s[1],n=new Blob([s[0]]).size);let a={comments:[],elements:[],headerLength:n,objInfo:""},i=r.split(/\r\n|\r|\n/);for(let e=0;e<i.length;e++){let r=i[e];if(""===(r=r.trim()))continue;let n=r.split(/\s+/),s=n.shift();switch(r=n.join(" "),s){case"format":a.format=n[0],a.version=n[1];break;case"comment":a.comments.push(r);break;case"element":void 0!==t&&a.elements.push(t),(t={}).name=n[0],t.count=parseInt(n[1]),t.properties=[];break;case"property":t.properties.push(function(e,t){let r={type:e[0]};return"list"===r.type?(r.name=e[3],r.countType=e[1],r.itemType=e[2]):r.name=e[1],r.name in t&&(r.name=t[r.name]),r}(n,f.propertyNameMapping));break;case"obj_info":a.objInfo=r;break;default:console.log("unhandled",s,n)}}return void 0!==t&&a.elements.push(t),a}function a(e,t){switch(t){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(e);case"float":case"double":case"float32":case"float64":return parseFloat(e)}}function i(){let e={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]};for(let t of Object.keys(f.customPropertyMapping))e[t]=[];return e}function o(e){let t=e.map(e=>e.name);function r(e){for(let r=0,n=e.length;r<n;r++){let n=e[r];if(t.includes(n))return n}return null}return{attrX:r(["x","px","posx"])||"x",attrY:r(["y","py","posy"])||"y",attrZ:r(["z","pz","posz"])||"z",attrNX:r(["nx","normalx"]),attrNY:r(["ny","normaly"]),attrNZ:r(["nz","normalz"]),attrS:r(["s","u","texture_u","tx"]),attrT:r(["t","v","texture_v","ty"]),attrR:r(["red","diffuse_red","r","diffuse_r"]),attrG:r(["green","diffuse_green","g","diffuse_g"]),attrB:r(["blue","diffuse_blue","b","diffuse_b"])}}function u(e,t){let r;let n=i(),s="";null!==(r=/end_header\s([\s\S]*)$/.exec(e))&&(s=r[1]);let u=s.split(/\r\n|\r|\n/),f=0,p=0,h=t.elements[f],d=o(h.properties);for(let e=0;e<u.length;e++){let r=u[e];if(""===(r=r.trim()))continue;p>=h.count&&(f++,p=0,d=o((h=t.elements[f]).properties));let s=function(e,t){let r=t.split(/\s+/),n={};for(let t=0;t<e.length;t++)if("list"===e[t].type){let s=[],i=a(r.shift(),e[t].countType);for(let n=0;n<i;n++)s.push(a(r.shift(),e[t].itemType));n[e[t].name]=s}else n[e[t].name]=a(r.shift(),e[t].type);return n}(h.properties,r);c(n,h.name,s,d),p++}return l(n)}function l(e){let t=new n.BufferGeometry;for(let r of(e.indices.length>0&&t.setIndex(e.indices),t.setAttribute("position",new n.Float32BufferAttribute(e.vertices,3)),e.normals.length>0&&t.setAttribute("normal",new n.Float32BufferAttribute(e.normals,3)),e.uvs.length>0&&t.setAttribute("uv",new n.Float32BufferAttribute(e.uvs,2)),e.colors.length>0&&t.setAttribute("color",new n.Float32BufferAttribute(e.colors,3)),e.faceVertexUvs.length>0&&(t=t.toNonIndexed()).setAttribute("uv",new n.Float32BufferAttribute(e.faceVertexUvs,2)),Object.keys(f.customPropertyMapping)))e[r].length>0&&t.setAttribute(r,new n.Float32BufferAttribute(e[r],f.customPropertyMapping[r].length));return t.computeBoundingSphere(),t}function c(e,t,r,n){if("vertex"===t)for(let t of(e.vertices.push(r[n.attrX],r[n.attrY],r[n.attrZ]),null!==n.attrNX&&null!==n.attrNY&&null!==n.attrNZ&&e.normals.push(r[n.attrNX],r[n.attrNY],r[n.attrNZ]),null!==n.attrS&&null!==n.attrT&&e.uvs.push(r[n.attrS],r[n.attrT]),null!==n.attrR&&null!==n.attrG&&null!==n.attrB&&(s.setRGB(r[n.attrR]/255,r[n.attrG]/255,r[n.attrB]/255).convertSRGBToLinear(),e.colors.push(s.r,s.g,s.b)),Object.keys(f.customPropertyMapping)))for(let n of f.customPropertyMapping[t])e[t].push(r[n]);else if("face"===t){let t=r.vertex_indices||r.vertex_index,n=r.texcoord;3===t.length?(e.indices.push(t[0],t[1],t[2]),n&&6===n.length&&(e.faceVertexUvs.push(n[0],n[1]),e.faceVertexUvs.push(n[2],n[3]),e.faceVertexUvs.push(n[4],n[5]))):4===t.length&&(e.indices.push(t[0],t[1],t[3]),e.indices.push(t[1],t[2],t[3]))}}let f=this;if(e instanceof ArrayBuffer){let n=new Uint8Array(e),s=function(e){let t=0,r=!0,n="",s=[];do{let a=String.fromCharCode(e[t++]);"\n"!==a&&"\r"!==a?n+=a:("end_header"===n&&(r=!1),""!==n&&(s.push(n),n=""))}while(r&&t<e.length);return s.join("\r")+"\r"}(n),a=r(s);if("ascii"===a.format){let e=new TextDecoder().decode(n);t=u(e,a)}else t=function(e,t){let r=i(),n="binary_little_endian"===t.format,s=new DataView(e,t.headerLength),a,u=0;for(let e=0;e<t.elements.length;e++){let i=t.elements[e],l=i.properties,f=o(l);!function(e,t,r){function n(e,t,r){switch(t){case"int8":case"char":return{read:t=>e.getInt8(t),size:1};case"uint8":case"uchar":return{read:t=>e.getUint8(t),size:1};case"int16":case"short":return{read:t=>e.getInt16(t,r),size:2};case"uint16":case"ushort":return{read:t=>e.getUint16(t,r),size:2};case"int32":case"int":return{read:t=>e.getInt32(t,r),size:4};case"uint32":case"uint":return{read:t=>e.getUint32(t,r),size:4};case"float32":case"float":return{read:t=>e.getFloat32(t,r),size:4};case"float64":case"double":return{read:t=>e.getFloat64(t,r),size:8}}}for(let s=0,a=e.length;s<a;s++){let a=e[s];"list"===a.type?(a.countReader=n(t,a.countType,r),a.valueReader=n(t,a.itemType,r)):a.valueReader=n(t,a.type,r)}}(l,s,n);for(let e=0;e<i.count;e++){a=function(e,t){let r={},n=0;for(let s=0;s<t.length;s++){let a=t[s],i=a.valueReader;if("list"===a.type){let t=[],s=a.countReader.read(e+n);n+=a.countReader.size;for(let r=0;r<s;r++)t.push(i.read(e+n)),n+=i.size;r[a.name]=t}else r[a.name]=i.read(e+n),n+=i.size}return[r,n]}(u,l),u+=a[1];let e=a[0];c(r,i.name,e,f)}}return l(r)}(e,a)}else t=u(e,r(e));return t}}}},function(e){e.O(0,[737,661,759,774,888,179],function(){return e(e.s=81940)}),_N_E=e.O()}]);