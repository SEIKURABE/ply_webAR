(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{48693:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDomainLocale=function(e,t,n,r){return!1},("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},16512:function(e,t,n){"use strict";var r=n(85696);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(92648).Z,a=n(17273).Z,s=o(n(67294)),i=n(65509),l=n(54514),u=n(44130),c=n(10146),f=n(84318),d=n(96514),p=n(18681),h=n(66675),m=n(48693),v=n(26085),g=new Set;function y(e,t,n,r,o){if(o||l.isLocalURL(t)){if(!r.bypassPrefetchedCheck){var a=t+"%"+n+"%"+(void 0!==r.locale?r.locale:"locale"in e?e.locale:void 0);if(g.has(a))return;g.add(a)}Promise.resolve(e.prefetch(t,n,r)).catch(function(e){})}}function b(e){return"string"==typeof e?e:u.formatUrl(e)}var x=s.default.forwardRef(function(e,t){var n,o,u=e.href,g=e.as,x=e.children,j=e.prefetch,_=e.passHref,w=e.replace,M=e.shallow,k=e.scroll,z=e.locale,P=e.onClick,C=e.onMouseEnter,N=e.onTouchStart,S=e.legacyBehavior,R=void 0!==S&&S,E=a(e,["href","as","children","prefetch","passHref","replace","shallow","scroll","locale","onClick","onMouseEnter","onTouchStart","legacyBehavior"]);n=x,R&&("string"==typeof n||"number"==typeof n)&&(n=s.default.createElement("a",null,n));var A=!1!==j,L=s.default.useContext(d.RouterContext),T=s.default.useContext(p.AppRouterContext),B=null!=L?L:T,O=!L,U=s.default.useMemo(function(){if(!L){var e=b(u);return{href:e,as:g?b(g):e}}var t=r(i.resolveHref(L,u,!0),2),n=t[0],o=t[1];return{href:n,as:g?i.resolveHref(L,g):o||n}},[L,u,g]),I=U.href,F=U.as,V=s.default.useRef(I),Y=s.default.useRef(F);R&&(o=s.default.Children.only(n));var X=R?o&&"object"==typeof o&&o.ref:t,Z=r(h.useIntersection({rootMargin:"200px"}),3),G=Z[0],D=Z[1],H=Z[2],K=s.default.useCallback(function(e){(Y.current!==F||V.current!==I)&&(H(),Y.current=F,V.current=I),G(e),X&&("function"==typeof X?X(e):"object"==typeof X&&(X.current=e))},[F,X,I,H,G]);s.default.useEffect(function(){B&&D&&A&&y(B,I,F,{locale:z},O)},[F,I,D,z,A,null==L?void 0:L.locale,B,O]);var q={ref:K,onClick:function(e){R||"function"!=typeof P||P(e),R&&o.props&&"function"==typeof o.props.onClick&&o.props.onClick(e),B&&!e.defaultPrevented&&function(e,t,n,r,o,a,i,u,c,f){if(!("A"===e.currentTarget.nodeName.toUpperCase()&&((d=e.currentTarget.getAttribute("target"))&&"_self"!==d||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which||!c&&!l.isLocalURL(n)))){e.preventDefault();var d,p=function(){"beforePopState"in t?t[o?"replace":"push"](n,r,{shallow:a,locale:u,scroll:i}):t[o?"replace":"push"](r||n,{forceOptimisticNavigation:!f})};c?s.default.startTransition(p):p()}}(e,B,I,F,w,M,k,z,O,A)},onMouseEnter:function(e){R||"function"!=typeof C||C(e),R&&o.props&&"function"==typeof o.props.onMouseEnter&&o.props.onMouseEnter(e),B&&(A||!O)&&y(B,I,F,{locale:z,priority:!0,bypassPrefetchedCheck:!0},O)},onTouchStart:function(e){R||"function"!=typeof N||N(e),R&&o.props&&"function"==typeof o.props.onTouchStart&&o.props.onTouchStart(e),B&&(A||!O)&&y(B,I,F,{locale:z,priority:!0,bypassPrefetchedCheck:!0},O)}};if(c.isAbsoluteUrl(F))q.href=F;else if(!R||_||"a"===o.type&&!("href"in o.props)){var W=void 0!==z?z:null==L?void 0:L.locale,$=(null==L?void 0:L.isLocaleDomain)&&m.getDomainLocale(F,W,null==L?void 0:L.locales,null==L?void 0:L.domainLocales);q.href=$||v.addBasePath(f.addLocale(F,W,null==L?void 0:L.defaultLocale))}return R?s.default.cloneElement(o,q):s.default.createElement("a",Object.assign({},E,q),n)});t.default=x,("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},66675:function(e,t,n){"use strict";var r=n(85696);Object.defineProperty(t,"__esModule",{value:!0}),t.useIntersection=function(e){var t=e.rootRef,n=e.rootMargin,u=e.disabled||!s,c=r(o.useState(!1),2),f=c[0],d=c[1],p=o.useRef(null),h=o.useCallback(function(e){p.current=e},[]);return o.useEffect(function(){if(s){if(!u&&!f){var e,r,o,c,h=p.current;if(h&&h.tagName)return r=(e=function(e){var t,n={root:e.root||null,margin:e.rootMargin||""},r=l.find(function(e){return e.root===n.root&&e.margin===n.margin});if(r&&(t=i.get(r)))return t;var o=new Map;return t={id:n,observer:new IntersectionObserver(function(e){e.forEach(function(e){var t=o.get(e.target),n=e.isIntersecting||e.intersectionRatio>0;t&&n&&t(n)})},e),elements:o},l.push(n),i.set(n,t),t}({root:null==t?void 0:t.current,rootMargin:n})).id,o=e.observer,(c=e.elements).set(h,function(e){return e&&d(e)}),o.observe(h),function(){if(c.delete(h),o.unobserve(h),0===c.size){o.disconnect(),i.delete(r);var e=l.findIndex(function(e){return e.root===r.root&&e.margin===r.margin});e>-1&&l.splice(e,1)}}}}else if(!f){var m=a.requestIdleCallback(function(){return d(!0)});return function(){return a.cancelIdleCallback(m)}}},[u,n,t,f,p.current]),[h,f,o.useCallback(function(){d(!1)},[])]};var o=n(67294),a=n(86682),s="function"==typeof IntersectionObserver,i=new Map,l=[];("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},66156:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return x}});var r=n(19848),o=n.n(r),a=n(67294),s=n(41664),i=n.n(s),l=n(33214),u=n(15029),c=n(59888),f=n(99477),d=n(51349),p=n(85893),h=function(e){var t=e.url,n=(0,a.useState)(null),r=n[0],o=n[1],s=(0,a.useState)(!0),i=s[0],l=s[1],u=(0,a.useState)(null),c=(u[0],u[1]),h=(0,a.useState)(!1),v=(h[0],h[1]),g=(0,a.useRef)(new f.PointsMaterial({size:.01,vertexColors:!0}));return((0,a.useRef)(new f.MeshStandardMaterial({color:16777215,flatShading:!0,vertexColors:!0})),(0,a.useEffect)(function(){var e=new d.F;l(!0),e.load(t,function(e){e.attributes.normal||e.computeVertexNormals();var t=!!e.attributes.color;v(t),t?console.log("PLYファイルに色情報が含まれています"):console.log("PLYファイルに色情報が含まれていません"),e.computeBoundingBox();var n=e.boundingBox;if(n){var r=new f.Vector3;n.getCenter(r),e.translate(-r.x,-r.y,-r.z);var a=n.getSize(new f.Vector3),s=Math.max(a.x,a.y,a.z);if(s>2){var i=2/s;e.scale(i,i,i)}}o(e),l(!1)},function(e){console.log(e.loaded/e.total*100+"% loaded")},function(e){console.error("PLYファイルの読み込みに失敗しました",e),c(Error(e.message||"PLYファイルの読み込みに失敗しました")),l(!1)})},[t]),i)?(0,p.jsx)(m,{}):r?(0,p.jsx)("points",{geometry:r,material:g.current}):null},m=function(){return(0,p.jsxs)("mesh",{children:[(0,p.jsx)("sphereGeometry",{args:[.5,16,16]}),(0,p.jsx)("meshStandardMaterial",{color:"gray",wireframe:!0})]})},v=function(){var e=(0,l.z)().scene;return(0,a.useEffect)(function(){e.background=new f.Color(1118481)},[e]),null},g=function(){var e=(0,l.z)().camera;return(0,a.useEffect)(function(){e.position.set(0,0,3),e.lookAt(0,0,0)},[e]),(0,p.jsx)(c.z,{enablePan:!0,enableZoom:!0,enableRotate:!0})},y=function(e){var t=e.size,n=a.useRef(null);return(0,a.useEffect)(function(){n.current&&n.current.material instanceof f.PointsMaterial&&(n.current.material.size=t,n.current.material.needsUpdate=!0)},[t]),null},b=function(e){var t=e.modelUrl,n=e.pointSize;return(0,p.jsx)("div",{style:{width:"100%",height:"100%"},children:(0,p.jsxs)(u.Xz,{shadows:!0,children:[(0,p.jsx)(v,{}),(0,p.jsx)("ambientLight",{intensity:.8}),(0,p.jsx)("directionalLight",{position:[10,10,5],intensity:1,castShadow:!0}),(0,p.jsx)("directionalLight",{position:[-10,-10,-5],intensity:.5}),(0,p.jsx)("hemisphereLight",{args:[16777215,4473924],intensity:.5}),(0,p.jsx)(h,{url:t}),(0,p.jsx)(g,{}),(0,p.jsx)(y,{size:void 0===n?.01:n})]})})},x=function(){return(0,p.jsxs)("div",{className:"jsx-2264227995 page-index",children:[(0,p.jsx)(b,{modelUrl:"/model/demo/frames/frame17.ply"}),(0,p.jsxs)("div",{className:"jsx-2264227995 menu",children:[(0,p.jsx)(i(),{className:"alink",href:"/",children:"Ply"}),(0,p.jsx)(i(),{className:"alink",href:"PlyAnimation",children:"PlyAnimation"}),(0,p.jsx)(i(),{className:"alink",href:"Spz",children:"Spz"}),(0,p.jsx)(i(),{className:"alink",href:"SpzAnimation",children:"SpzAnimation"})]}),(0,p.jsx)(o(),{id:"2264227995",children:[".page-index{width:100%;height:100%;background-color:#fff;position:absolute;}",".menu{background-color:#222;list-style:none;padding:16px;position:fixed;bottom:0;left:0;z-index:100;}",".alink{color:#fff;}",".alink+.alink{margin-left:16px;}"]})]})}},48312:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(66156)}])},41664:function(e,t,n){e.exports=n(16512)},51349:function(e,t,n){"use strict";n.d(t,{F:function(){return a}});var r=n(99477);let o=new r.Color;class a extends r.Loader{constructor(e){super(e),this.propertyNameMapping={},this.customPropertyMapping={}}load(e,t,n,o){let a=this,s=new r.FileLoader(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(n){try{t(a.parse(n))}catch(t){o?o(t):console.error(t),a.manager.itemError(e)}},n,o)}setPropertyNameMapping(e){this.propertyNameMapping=e}setCustomPropertyNameMapping(e){this.customPropertyMapping=e}parse(e){let t;function n(e){let t;let n="",r=0,o=/^ply([\s\S]*)end_header(\r\n|\r|\n)/.exec(e);null!==o&&(n=o[1],r=new Blob([o[0]]).size);let a={comments:[],elements:[],headerLength:r,objInfo:""},s=n.split(/\r\n|\r|\n/);for(let e=0;e<s.length;e++){let n=s[e];if(""===(n=n.trim()))continue;let r=n.split(/\s+/),o=r.shift();switch(n=r.join(" "),o){case"format":a.format=r[0],a.version=r[1];break;case"comment":a.comments.push(n);break;case"element":void 0!==t&&a.elements.push(t),(t={}).name=r[0],t.count=parseInt(r[1]),t.properties=[];break;case"property":t.properties.push(function(e,t){let n={type:e[0]};return"list"===n.type?(n.name=e[3],n.countType=e[1],n.itemType=e[2]):n.name=e[1],n.name in t&&(n.name=t[n.name]),n}(r,f.propertyNameMapping));break;case"obj_info":a.objInfo=n;break;default:console.log("unhandled",o,r)}}return void 0!==t&&a.elements.push(t),a}function a(e,t){switch(t){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(e);case"float":case"double":case"float32":case"float64":return parseFloat(e)}}function s(){let e={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]};for(let t of Object.keys(f.customPropertyMapping))e[t]=[];return e}function i(e){let t=e.map(e=>e.name);function n(e){for(let n=0,r=e.length;n<r;n++){let r=e[n];if(t.includes(r))return r}return null}return{attrX:n(["x","px","posx"])||"x",attrY:n(["y","py","posy"])||"y",attrZ:n(["z","pz","posz"])||"z",attrNX:n(["nx","normalx"]),attrNY:n(["ny","normaly"]),attrNZ:n(["nz","normalz"]),attrS:n(["s","u","texture_u","tx"]),attrT:n(["t","v","texture_v","ty"]),attrR:n(["red","diffuse_red","r","diffuse_r"]),attrG:n(["green","diffuse_green","g","diffuse_g"]),attrB:n(["blue","diffuse_blue","b","diffuse_b"])}}function l(e,t){let n;let r=s(),o="";null!==(n=/end_header\s([\s\S]*)$/.exec(e))&&(o=n[1]);let l=o.split(/\r\n|\r|\n/),f=0,d=0,p=t.elements[f],h=i(p.properties);for(let e=0;e<l.length;e++){let n=l[e];if(""===(n=n.trim()))continue;d>=p.count&&(f++,d=0,h=i((p=t.elements[f]).properties));let o=function(e,t){let n=t.split(/\s+/),r={};for(let t=0;t<e.length;t++)if("list"===e[t].type){let o=[],s=a(n.shift(),e[t].countType);for(let r=0;r<s;r++)o.push(a(n.shift(),e[t].itemType));r[e[t].name]=o}else r[e[t].name]=a(n.shift(),e[t].type);return r}(p.properties,n);c(r,p.name,o,h),d++}return u(r)}function u(e){let t=new r.BufferGeometry;for(let n of(e.indices.length>0&&t.setIndex(e.indices),t.setAttribute("position",new r.Float32BufferAttribute(e.vertices,3)),e.normals.length>0&&t.setAttribute("normal",new r.Float32BufferAttribute(e.normals,3)),e.uvs.length>0&&t.setAttribute("uv",new r.Float32BufferAttribute(e.uvs,2)),e.colors.length>0&&t.setAttribute("color",new r.Float32BufferAttribute(e.colors,3)),e.faceVertexUvs.length>0&&(t=t.toNonIndexed()).setAttribute("uv",new r.Float32BufferAttribute(e.faceVertexUvs,2)),Object.keys(f.customPropertyMapping)))e[n].length>0&&t.setAttribute(n,new r.Float32BufferAttribute(e[n],f.customPropertyMapping[n].length));return t.computeBoundingSphere(),t}function c(e,t,n,r){if("vertex"===t)for(let t of(e.vertices.push(n[r.attrX],n[r.attrY],n[r.attrZ]),null!==r.attrNX&&null!==r.attrNY&&null!==r.attrNZ&&e.normals.push(n[r.attrNX],n[r.attrNY],n[r.attrNZ]),null!==r.attrS&&null!==r.attrT&&e.uvs.push(n[r.attrS],n[r.attrT]),null!==r.attrR&&null!==r.attrG&&null!==r.attrB&&(o.setRGB(n[r.attrR]/255,n[r.attrG]/255,n[r.attrB]/255).convertSRGBToLinear(),e.colors.push(o.r,o.g,o.b)),Object.keys(f.customPropertyMapping)))for(let r of f.customPropertyMapping[t])e[t].push(n[r]);else if("face"===t){let t=n.vertex_indices||n.vertex_index,r=n.texcoord;3===t.length?(e.indices.push(t[0],t[1],t[2]),r&&6===r.length&&(e.faceVertexUvs.push(r[0],r[1]),e.faceVertexUvs.push(r[2],r[3]),e.faceVertexUvs.push(r[4],r[5]))):4===t.length&&(e.indices.push(t[0],t[1],t[3]),e.indices.push(t[1],t[2],t[3]))}}let f=this;if(e instanceof ArrayBuffer){let r=new Uint8Array(e),o=function(e){let t=0,n=!0,r="",o=[];do{let a=String.fromCharCode(e[t++]);"\n"!==a&&"\r"!==a?r+=a:("end_header"===r&&(n=!1),""!==r&&(o.push(r),r=""))}while(n&&t<e.length);return o.join("\r")+"\r"}(r),a=n(o);if("ascii"===a.format){let e=new TextDecoder().decode(r);t=l(e,a)}else t=function(e,t){let n=s(),r="binary_little_endian"===t.format,o=new DataView(e,t.headerLength),a,l=0;for(let e=0;e<t.elements.length;e++){let s=t.elements[e],u=s.properties,f=i(u);!function(e,t,n){function r(e,t,n){switch(t){case"int8":case"char":return{read:t=>e.getInt8(t),size:1};case"uint8":case"uchar":return{read:t=>e.getUint8(t),size:1};case"int16":case"short":return{read:t=>e.getInt16(t,n),size:2};case"uint16":case"ushort":return{read:t=>e.getUint16(t,n),size:2};case"int32":case"int":return{read:t=>e.getInt32(t,n),size:4};case"uint32":case"uint":return{read:t=>e.getUint32(t,n),size:4};case"float32":case"float":return{read:t=>e.getFloat32(t,n),size:4};case"float64":case"double":return{read:t=>e.getFloat64(t,n),size:8}}}for(let o=0,a=e.length;o<a;o++){let a=e[o];"list"===a.type?(a.countReader=r(t,a.countType,n),a.valueReader=r(t,a.itemType,n)):a.valueReader=r(t,a.type,n)}}(u,o,r);for(let e=0;e<s.count;e++){a=function(e,t){let n={},r=0;for(let o=0;o<t.length;o++){let a=t[o],s=a.valueReader;if("list"===a.type){let t=[],o=a.countReader.read(e+r);r+=a.countReader.size;for(let n=0;n<o;n++)t.push(s.read(e+r)),r+=s.size;n[a.name]=t}else n[a.name]=s.read(e+r),r+=s.size}return[n,r]}(l,u),l+=a[1];let e=a[0];c(n,s.name,e,f)}}return u(n)}(e,a)}else t=l(e,n(e));return t}}}},function(e){e.O(0,[737,848,661,759,774,888,179],function(){return e(e.s=48312)}),_N_E=e.O()}]);